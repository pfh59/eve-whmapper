services:
  db:
    image: postgres:15-alpine
    restart: always
    environment:
      POSTGRES_USER: ${POSTGRES_USER:-postgres}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-1}
      POSTGRES_DB: whmapper
      PGDATA: /data/postgres
    volumes:
     - postgres:/data/postgres
    networks:
     - net

  redis:
    image: redis:7-alpine
    restart: always
    networks:
     - net

  whmapper:
    image: ghcr.io/pfh59/eve-whmapper:1.1
    restart: unless-stopped
    environment:
     - EveSSO__ClientId=987
     - EveSSO__Secret=p
     - ConnectionStrings__DatabaseConnection=server=db;port=5432;database=whmapper;User Id=postgres;Password=1
     - ConnectionStrings__RedisConnection=redis:6379
     - Logging__LogLevel__Default=Warning
     - Logging__LogLevel__Microsoft.EntityFrameworkCore.Database.Command=Warning
    links:
      - db     
    depends_on:
      - db 
    networks:
     - net

networks:
  net:

volumes:
    postgres:
