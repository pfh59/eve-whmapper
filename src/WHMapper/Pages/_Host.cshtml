@page "/"
@using System.Security.Claims
@using Microsoft.AspNetCore.Authentication
@using Microsoft.Net.Http.Headers;
@using WHMapper.Shared.Models.DTO;
@using WHMapper.Shared.Services.EveOAuthProvider;
    
@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery Xsrf

@namespace WHMapper.Pages
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "_Layout";


    var tokens = new InitialApplicationState
    {
        AccessToken = await HttpContext.GetTokenAsync(EVEOnlineAuthenticationDefaults.AuthenticationScheme, "access_token"),
        RefreshToken = await HttpContext.GetTokenAsync(EVEOnlineAuthenticationDefaults.AuthenticationScheme, "refresh_token"),
        XsrfToken = Xsrf.GetAndStoreTokens(HttpContext).RequestToken
    };
}

<component type="typeof(App)" render-mode="Server" param-InitialState="tokens" />

