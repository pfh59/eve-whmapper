@using WHMapper.Models.DTO.EveMapper.EveEntity

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.PersonAdd" Class="mr-2" />
            Add Administrator
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudForm @ref="_form" @bind-IsValid="_formIsValid">
            <MudText Typo="Typo.body2" Class="mb-4">
                Search for a character to add as an administrator of this instance.
            </MudText>
            
            <MudAutocomplete T="CharactereEntity" 
                             Label="Search Character" 
                             @bind-Value="_selectedCharacter"
                             SearchFunc="SearchCharacter"
                             ToStringFunc="@(e => e?.Name ?? string.Empty)"
                             Required="true"
                             RequiredError="Please select a character"
                             Dense="true"
                             Class="mb-4">
                <ItemTemplate Context="item">
                    <MudStack Row="true" AlignItems="AlignItems.Center">
                        <MudAvatar Size="Size.Small">
                            <MudImage Src="@($"https://images.evetech.net/characters/{item.Id}/portrait?size=64")" />
                        </MudAvatar>
                        <MudText>@item.Name</MudText>
                    </MudStack>
                </ItemTemplate>
            </MudAutocomplete>
        </MudForm>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Success" OnClick="Add" Disabled="@(_selectedCharacter == null || _adding)">
            @if (_adding)
            {
                <MudProgressCircular Size="Size.Small" Indeterminate="true" Class="mr-2" />
            }
            Add Administrator
        </MudButton>
    </DialogActions>
</MudDialog>
